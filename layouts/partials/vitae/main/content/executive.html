{{- $pp := . }}
{{- $page := .Page }}
{{- $template := printf "vitae/main/content/executive)" }}

{{ partial "html-comment" (printf "BEGIN '%s'" $template) }}

{{- $vitaeParams := $pp.VitaeParams }}
{{- $vitaeData := $pp.VitaeData }}

<!-- Pagination
Part: an independent section of one or more printed pages
PaginationPage: a printed page that is part of a Part
-->
{{- range $partIndex, $part := where $vitaeParams.parts "enabled" "ne" false }}
  <!-- Initially, all content is placed within one Pagination Page
  When rendering the print preview with `print-view.js`,
  this DOM node is cloned and the content is distributed across as many
  clones as required -->
  {{- $partClassList := (slice
      (printf "template_%s" $part.template)
      (printf "%s%d" $pp.PartClassPrefix $partIndex)
      $pp.PaginationPageClass
    ) -}}
  {{- with $vitaeParams.footer }}
    {{- $partClassList = append (printf "footer_%s" .template) $partClassList }}
  {{- end }}
  <div class="{{ delimit $partClassList ` `}}">
    {{- range $slotIndex, $slot := $part.slots }}
      {{/* {{- partial "html-comment" (printf "[%s]: slot[%T] name=%s:\n%v"
          $template $slot $slot.slot (jsonify (dict "indent" "  ") $slot) ) }} */}}
      <div class="{{ printf "slot_%s" $slot.slot }} {{ $pp.PaginationContainerClass }}"
      {{- $paginationPolicy := default "break" $part.pagination_policy }}
      {{ printf `%s="%d"` $pp.PaginationOrderAttr 9 | safeHTMLAttr }}
      {{ printf `%s="%s"` $pp.PaginationPolicyAttr $paginationPolicy | safeHTMLAttr -}}
      >
        {{- $childClass := default "" .child_class }}
        {{- partial "vitae/_components/index" (dict
          "Page" $page
          "Config" $vitaeParams
          "ChildClass" $childClass
          "Data" $vitaeData
          "Sections" $slot.sections
        ) -}}
      </div>
    {{- end }}
    {{- with $vitaeParams.footer }}
      {{- $footerContainer := default "footer" .container }}
      {{- if $footerContainer }}
        {{ printf `<%s class="slot_footer footer_%s">` $footerContainer .template | safeHTML }}
      {{- end }}
      {{- range $componentIndex, $component := .components }}
        {{- $componentName := $component.component }}
        {{- $childClass := default "" .child_class }}
        {{- $componentPartial := printf "vitae/_components/%s" $componentName }}
        {{- $componentContainer := default "" .container }}
        {{- if $componentContainer }}
          {{- printf `<%s class="component-container_%s component-container">` $componentContainer $componentName | safeHTML }}
        {{- end }}
        {{- $componentStyle := $component.style | default false }}
        {{- partial $componentPartial (dict
          "Page" $page
          "Config" $vitaeParams
          "Component" $component
          "Style" $componentStyle
          "Index" $componentIndex
          "ChildClass" $childClass
          "Container" false
          "Data" $vitaeData
        ) -}}
      {{- end }}
      {{- with $footerContainer }}
        {{ printf "</%s>" . | safeHTML }}
      {{- end }}
    {{- end }}
  </div>
{{- end }}
{{ partial "html-comment" (printf "END   '%s'" $template) }}
