{{- $pp := . }}
{{- $page := .Page }}
{{- $templateName := "executive" }}
{{- $template := printf "vitae/main/content/%s" $templateName }}

{{ partial "html-comment" (printf "BEGIN '%s'" $template) }}

{{- $vitaeParams := $pp.VitaeParams }}
{{- $vitaeData := $pp.VitaeData }}

{{- $debug := false }}
{{/* {{- $debug = or $debug (not (not (findRE `^/([^/]+-demo/)?preview-ats` $page.RelPermalink) ) ) -}} */}}

{{- $vitaeStyle := default dict $pp.VitaeStyle }}

{{- $validStyles := merge (default dict .ValidStyles) (dict
  "layout" (dict
    "shallow" "shallow"
    "narrow" "narrow"
    "inline" "inline"
    "compact" (slice "shallow" "narrow" "inline")
  )
  "timeline" (dict
    "false" false
    "true" "column"
  )
  "heading" (dict
    "normal" "normal"
    "larger-1" "larger-1"
    "smaller-1" "smaller-1"
  )
  "logo" (dict
    "false" false
    "true" "left"
    "left" "left"
  )
) -}}

{{- $styleClassList := partial "vitae/_functions/style-class" (dict
  "Template" $template
  "Style" $vitaeStyle
  "ValidStyles" $validStyles
  ) -}}

{{- if $debug }}
  {{- warnf "%s[%s]:\nstyle=%v\nvalidStyles=%v" $page $template
      (jsonify (dict "indent" "  ") $vitaeStyle)
      (jsonify (dict "indent" "  ") $validStyles ) }}
{{- end }}

<!-- Pagination
Part: an independent section of one or more printed pages
PaginationPage: a printed page that is part of a Part
-->
{{- range $partIndex, $part := where $vitaeParams.parts "enabled" "ne" false }}
  <!-- Initially, all content is placed within one Pagination Page
  When rendering the print preview with `print-view.js`,
  this DOM node is cloned and the content is distributed across as many
  clones as required -->
  {{- $partClassList := append $styleClassList (slice
      (printf "template_%s" $part.template)
      (printf "%s%d" $pp.PartClassPrefix $partIndex)
      $pp.PaginationPageClass
    ) -}}
  {{- $footer := false }}
  {{- with $vitaeParams.footer }}
    {{- if and (not (in (slice true) $vitaeStyle.ats)) (default true $part.footer.enabled) }}
      {{- $footer = . }}
      {{- $partClassList = append (printf "footer_%s" .template) $partClassList }}
    {{- end }}
  {{- end }}
  <div class="{{ delimit $partClassList ` `}}">
    {{- range $slotIndex, $slot := $part.slots }}
      {{/* {{- partial "html-comment" (printf "[%s]: slot[%T] name=%s:\n%v"
          $template $slot $slot.slot (jsonify (dict "indent" "  ") $slot) ) }} */}}
      <div class="{{ printf "slot_%s" $slot.slot }} {{ $pp.PaginationContainerClass }}"
      {{- $paginationPolicy := default "break" $part.pagination_policy }}
      {{ printf `%s="%d"` $pp.PaginationOrderAttr 9 | safeHTMLAttr }}
      {{ printf `%s="%s"` $pp.PaginationPolicyAttr $paginationPolicy | safeHTMLAttr -}}
      >
        {{- $childClass := default "" .child_class }}
        {{- partial "vitae/_components/index" (dict
          "Page" $page
          "Config" $vitaeParams
          "Style" $vitaeStyle
          "ValidStyles" $validStyles
          "ChildClass" $childClass
          "Data" $vitaeData
          "Sections" $slot.sections
        ) -}}
      </div>
    {{- end }}
    {{- with $footer }}
      {{- $footerContainer := default "footer" .container }}
      {{- if $footerContainer }}
        {{ printf `<%s class="slot_footer footer_%s">` $footerContainer .template | safeHTML }}
      {{- end }}
      {{- $childClass := default "" .child_class }}
      {{- partial "vitae/_components/index" (dict
        "Page" $page
        "Config" $vitaeParams
        "Style" $vitaeStyle
        "ValidStyles" $validStyles
        "ChildClass" $childClass
        "Data" $vitaeData
        "Sections" .sections
      ) -}}
      {{- with $footerContainer }}
        {{ printf "</%s>" . | safeHTML }}
      {{- end }}
    {{- end }}
  </div>
{{- end }}
{{ partial "html-comment" (printf "END   '%s'" $template) }}
